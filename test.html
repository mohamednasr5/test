<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {
    margin: 0; padding: 0;
    font-family: "Cairo", sans-serif;
    background-color: #0f0f1a;
    color: white;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  /* Stats Card */
  .stats-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 40px;
    border-radius: 40px;
    text-align: center;
    box-shadow: 0 0 50px rgba(102, 126, 234, 0.15);
    width: 90%;
    max-width: 500px;
    margin-bottom: 30px;
  }

  .number-display {
    font-size: 6rem;
    font-weight: 900;
    background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
    margin: 10px 0;
  }

  /* Messaging Section */
  .msg-card {
    background: #fff;
    color: #333;
    width: 90%;
    max-width: 500px;
    padding: 20px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }

  h2 { margin: 0 0 15px 0; color: #4facfe; text-align: center; }

  .msg-input {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 10px;
    font-size: 1rem;
    font-family: inherit;
    box-sizing: border-box;
    margin-bottom: 10px;
  }
  
  .send-btn {
    width: 100%;
    padding: 12px;
    background: linear-gradient(135deg, #ff9800 0%, #ff5722 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }
  .send-btn:hover { transform: scale(1.02); }
  .send-btn:active { transform: scale(0.98); }

  .status-text { margin-top: 10px; text-align: center; font-size: 0.9em; color: green; display: none; }
</style>
</head>
<body>

<div class="stats-card">
  <div style="font-size: 1.2rem; color: #ccc;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù†Ø¸Ø§Ù…</div>
  <div class="number-display" id="count-display">0</div>
  <div style="font-size: 0.9rem; color: #666;">ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Firebase ğŸ”¥</div>
</div>

<div class="msg-card">
  <h2>ğŸ“¢ Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
  <input type="text" id="msg-input" class="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§ (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù†ØªØ¨Ù‡ÙˆØ§ Ù„Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ)">
  <button class="send-btn" id="send-btn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙˆØ±Ø§Ù‹ ğŸš€</button>
  <div class="status-text" id="status-msg">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!</div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAoZE2KL3APojd929VEbhSv914jzDv90wA",
    authDomain: "test-dd8b4.firebaseapp.com",
    databaseURL: "https://test-dd8b4-default-rtdb.firebaseio.com",
    projectId: "test-dd8b4",
    storageBucket: "test-dd8b4.firebasestorage.app",
    messagingSenderId: "761689441004",
    appId: "1:761689441004:web:667a3fae42f3cf84071bc9",
    measurementId: "G-PP1BG203MT"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // 1. Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†
  const countRef = ref(db, 'stats/logins');
  onValue(countRef, (snapshot) => {
    const val = snapshot.val() || 0;
    document.getElementById("count-display").innerText = val;
  });

  // 2. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
  document.getElementById("send-btn").addEventListener("click", () => {
    const input = document.getElementById("msg-input");
    const msg = input.value.trim();
    
    if (!msg) return alert("Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹");

    // Ù†ÙƒØªØ¨ ÙÙŠ Ù…ÙƒØ§Ù† 'broadcast_message' ÙˆÙ†Ø¶Ø¹ Ø·Ø§Ø¨Ø¹ Ø²Ù…Ù†ÙŠ Ù„Ø¶Ù…Ø§Ù† ØªØºÙŠØ± Ø§Ù„Ù‚ÙŠÙ…Ø©
    set(ref(db, 'broadcast_message'), {
      text: msg,
      timestamp: Date.now()
    }).then(() => {
      // Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
      input.value = "";
      const status = document.getElementById("status-msg");
      status.style.display = "block";
      setTimeout(() => status.style.display = "none", 3000);
    }).catch((err) => {
      alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + err.message);
    });
  });

</script>

</body>
</html>
